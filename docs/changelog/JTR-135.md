# JTR-135

- Date: 2026-03-02
- Scope: improve ticket comment timeline UX (avatar/time formatting) and add delete-own-comment flow

## What changed

- Enhanced `JTimeline` presentation:
  - avatar circle (image or initials),
  - relative timestamp formatting (`just now`, `x hours ago`, `yesterday`),
  - preserved absolute timestamp in tooltip.
- Added comment deletion interaction in timeline:
  - timeline accepts `deletableCommentIds`,
  - renders `Delete` action only for eligible comment items,
  - supports delete-in-progress state.
- Extended timeline item typing (`actor.id`, `commentId`) to support ownership-based actions.
- Updated ticket activity composable to propagate actor IDs and comment IDs into timeline items.
- Updated ticket detail page:
  - computes current-user deletable comment IDs,
  - handles delete confirmation + `repository.deleteComment()` + sync.
- Added `deleteComment()` in offline repository:
  - soft-delete local comment (`deletedAt`),
  - enqueue outbox delete operation for `ticketComments`.

## Docs updated

- `docs/architecture.md`
- `docs/system-design.md`
- `docs/plans/ui-ux-plan.md`

## Files

- `apps/web/components/ui/JTimeline.vue`
- `apps/web/composables/useTicketActivity.ts`
- `apps/web/composables/useOfflineRepository.ts`
- `apps/web/pages/tickets/[id].vue`
- `apps/web/types/ui.ts`
- `docs/architecture.md`
- `docs/system-design.md`
- `docs/plans/ui-ux-plan.md`
- `docs/changelog/JTR-135.md`

## Verification

- `pnpm --filter @jtrack/web typecheck`
- `pnpm --filter @jtrack/web test -- stores/sync.spec.ts stores/location.spec.ts`
